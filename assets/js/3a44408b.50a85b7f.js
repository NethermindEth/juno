"use strict";(self.webpackChunkjuno_docs=self.webpackChunkjuno_docs||[]).push([[2957],{5712:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var t=s(4848),a=s(8453);const o={title:"Monitoring Juno"},r="Monitoring Juno :bar_chart:",i={id:"monitoring",title:"Monitoring Juno",description:"Juno uses Prometheus to monitor and collect metrics data, which you can visualise with Grafana. You can use these insights to understand what is happening when Juno is running.",source:"@site/versioned_docs/version-0.11.8/monitoring.md",sourceDirName:".",slug:"/monitoring",permalink:"/monitoring",draft:!1,unlisted:!1,tags:[],version:"0.11.8",frontMatter:{title:"Monitoring Juno"},sidebar:"main",previous:{title:"WebSocket Interface",permalink:"/websocket"},next:{title:"Database Snapshots",permalink:"/snapshots"}},l={},c=[{value:"Enable the metrics server",id:"enable-the-metrics-server",level:2},{value:"Configure Grafana dashboard",id:"configure-grafana-dashboard",level:2},{value:"1. Set up Grafana",id:"1-set-up-grafana",level:3},{value:"2. Set up Prometheus",id:"2-set-up-prometheus",level:3},{value:"3. Set up Grafana Loki",id:"3-set-up-grafana-loki",level:3},{value:"4. Configure the data sources",id:"4-configure-the-data-sources",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.h1,{id:"monitoring-juno-bar_chart",children:["Monitoring Juno ","\ud83d\udcca"]}),"\n",(0,t.jsxs)(n.p,{children:["Juno uses ",(0,t.jsx)(n.a,{href:"https://prometheus.io/",children:"Prometheus"})," to monitor and collect metrics data, which you can visualise with ",(0,t.jsx)(n.a,{href:"https://grafana.com/",children:"Grafana"}),". You can use these insights to understand what is happening when Juno is running."]}),"\n",(0,t.jsx)(n.h2,{id:"enable-the-metrics-server",children:"Enable the metrics server"}),"\n",(0,t.jsx)(n.p,{children:"To enable the metrics server, use the following configuration options:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"metrics"}),": Enables the Prometheus metrics endpoint on the default port (disabled by default)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"metrics-host"}),": The interface on which the Prometheus endpoint will listen for requests. If skipped, it defaults to ",(0,t.jsx)(n.code,{children:"localhost"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"metrics-port"}),": The port on which the Prometheus endpoint will listen for requests. If skipped, it defaults to ",(0,t.jsx)(n.code,{children:"9090"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# Docker container\ndocker run -d \\\n  --name juno \\\n  -p 9090:9090 \\\n  nethermind/juno \\\n  --metrics \\\n  --metrics-port 9090 \\\n  --metrics-host 0.0.0.0\n\n# Standalone binary\n./build/juno --metrics --metrics-port 9090 --metrics-host=0.0.0.0\n"})}),"\n",(0,t.jsx)(n.h2,{id:"configure-grafana-dashboard",children:"Configure Grafana dashboard"}),"\n",(0,t.jsx)(n.h3,{id:"1-set-up-grafana",children:"1. Set up Grafana"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Follow the ",(0,t.jsx)(n.a,{href:"https://grafana.com/docs/grafana/latest/setup-grafana/",children:"Set up Grafana"})," guide to install Grafana."]}),"\n",(0,t.jsxs)(n.li,{children:["Download and ",(0,t.jsx)(n.a,{href:"https://grafana.com/docs/grafana/latest/setup-grafana/configure-grafana/#configuration-file-location",children:"configure"})," the ",(0,t.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(7415).A+"",children:"Grafana dashboard file"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"2-set-up-prometheus",children:"2. Set up Prometheus"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Follow the ",(0,t.jsx)(n.a,{href:"https://prometheus.io/docs/introduction/first_steps/",children:"First steps with Prometheus"})," guide to install Prometheus."]}),"\n",(0,t.jsxs)(n.li,{children:["Add the Juno metrics endpoint in the ",(0,t.jsx)(n.code,{children:"prometheus.yml"})," configuration file:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="prometheus.yml" showLineNumbers',children:'scrape_configs:\n  - job_name: "juno"\n    static_configs:\n      - targets: ["localhost:9090"]\n'})}),"\n",(0,t.jsx)(n.h3,{id:"3-set-up-grafana-loki",children:"3. Set up Grafana Loki"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Follow the ",(0,t.jsx)(n.a,{href:"https://grafana.com/docs/loki/latest/get-started/",children:"Get started with Grafana Loki"})," guide to install ",(0,t.jsx)(n.a,{href:"https://grafana.com/oss/loki/",children:"Loki"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Configure Loki to ",(0,t.jsx)(n.a,{href:"https://grafana.com/docs/loki/latest/send-data/",children:"collect logs"})," from Juno. You might need to configure log paths or use ",(0,t.jsx)(n.a,{href:"https://grafana.com/docs/loki/latest/send-data/promtail/",children:"Promtail"})," (Loki's agent) to send logs to Loki:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="Sample Loki Configuration" showLineNumbers',children:'scrape_configs:\n  - job_name: "juno-logs"\n    labels:\n      job: "juno"\n      __path__: "/path/to/juno/logs/*"\n'})}),"\n",(0,t.jsxs)(n.admonition,{type:"tip",children:[(0,t.jsx)(n.p,{children:"To have Juno write logs to a file, use the command:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"./build/juno >> /path/juno.log 2>&1\n"})})]}),"\n",(0,t.jsx)(n.h3,{id:"4-configure-the-data-sources",children:"4. Configure the data sources"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Follow the ",(0,t.jsx)(n.a,{href:"https://grafana.com/docs/grafana/latest/datasources/",children:"Grafana data sources"})," guide to add data sources."]}),"\n",(0,t.jsxs)(n.li,{children:["Choose ",(0,t.jsx)(n.strong,{children:"Prometheus"})," as a data source:"]}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Enter the URL where Prometheus is running, e.g., ",(0,t.jsx)(n.code,{children:"http://localhost:9090"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Click the ",(0,t.jsx)(n.strong,{children:'"Save & Test"'})," button."]}),"\n"]}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsxs)(n.li,{children:["Choose ",(0,t.jsx)(n.strong,{children:"Loki"})," as a data source:"]}),"\n"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Enter the URL where Loki is running, e.g., ",(0,t.jsx)(n.code,{children:"http://localhost:3100"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Click the ",(0,t.jsx)(n.strong,{children:'"Save & Test"'})," button."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Grafana dashboard",src:s(9035).A+"",width:"2866",height:"1334"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"Grafana dashboard",src:s(9184).A+"",width:"2865",height:"1143"})})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},7415:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/files/juno_grafana-925a98441f53112dabb0630c6f72b866.json"},9035:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/grafana-1-2f649b30cd0952c8fb1d56685f13b7d2.png"},9184:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/grafana-2-d99c7b9df8563a709a965e028ca34e57.png"},8453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>i});var t=s(6540);const a={},o=t.createContext(a);function r(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);